# NewAPI æ™ºèƒ½æ›¿æ¢è§£å†³æ–¹æ¡ˆ - é…ç½®æŒ‡å—

## ğŸ¯ é…ç½®å®ŒæˆçŠ¶æ€

âœ… **æœ¬åœ°å¼€å‘ç¯å¢ƒå·²å°±ç»ª**ï¼š
- å·²å°†é¡¹ç›®ä¾èµ–åˆ‡æ¢åˆ°æœ¬åœ°æ„å»ºçš„ `llms-src`
- NewAPITransformer å·²æ³¨å†Œåˆ°è½¬æ¢å™¨æœåŠ¡
- é…ç½®æ–‡ä»¶å·²æ›´æ–°ä¸ºä½¿ç”¨NewAPIæä¾›å•†

## ğŸ“ é…ç½®æ­¥éª¤

### 1. æ›´æ–°ä½ çš„ NewAPI ä¿¡æ¯

ç¼–è¾‘ `config.json`ï¼Œå°†ä»¥ä¸‹å ä½ç¬¦æ›¿æ¢ä¸ºå®é™…å€¼ï¼š

```json
{
  "providers": [
    {
      "name": "newapi",
      "api_base_url": "https://ä½ çš„newapiåŸŸå.com/v1/chat/completions",
      "api_key": "ä½ çš„api-key",
      "models": [
        "claude-sonnet-4-20250514-thinking",
        "claude-3-7-sonnet-20250219", 
        "gemini-2.5-pro-preview-06-05"
      ],
      "transformer": {
        "use": ["newapi"]
      }
    }
  ]
}
```

### 2. æµ‹è¯•é…ç½®

å¯åŠ¨claude-code-routerï¼š
```bash
npm start
# æˆ–è€…å¦‚æœæ˜¯å…¨å±€å®‰è£…çš„è¯
ccr
```

### 3. éªŒè¯NewAPIåŠŸèƒ½

ä½¿ç”¨åŒ…å«MCPå·¥å…·è°ƒç”¨çš„è¯·æ±‚æµ‹è¯•ï¼š
- **Claude thinkingæ¨¡å¼**ï¼šä½¿ç”¨ `claude-sonnet-4-20250514-thinking`
- **Gemini JSON Schema**ï¼šä½¿ç”¨ `gemini-2.5-pro-preview-06-05` 

## ğŸ” æ™ºèƒ½æ›¿æ¢æ•ˆæœ

### Claude Thinkingæ¨¡å¼
**ä¹‹å‰æŠ¥é”™**ï¼š`Expected 'thinking' or 'redacted_thinking', but found 'text'`  
**ç°åœ¨ä¿®å¤**ï¼šè‡ªåŠ¨æ·»åŠ æ­£ç¡®çš„thinkingå‚æ•°æ ¼å¼

### Gemini JSON Schema  
**ä¹‹å‰æŠ¥é”™**ï¼š`Unknown name "const" at 'tools[0].function_declarations'`  
**ç°åœ¨ä¿®å¤**ï¼šæ™ºèƒ½è½¬æ¢ `const: "value"` â†’ `enum: ["value"]`

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

- âœ… **åŠŸèƒ½å®Œæ•´æ€§ä¿æŒ**ï¼šè½¬æ¢è€Œéåˆ é™¤ï¼Œä¿æŒæ‰€æœ‰çº¦æŸèƒ½åŠ›
- âœ… **æ™ºèƒ½é”™è¯¯è¯Šæ–­**ï¼šè¯¦ç»†çš„é”™è¯¯åˆ†æå’Œä¿®å¤å»ºè®®
- âœ… **è‡ªåŠ¨éªŒè¯**ï¼šç¡®ä¿è½¬æ¢åçš„å·¥å…·å®šä¹‰ä»ç„¶æœ‰æ•ˆ
- âœ… **è¯¦ç»†æ—¥å¿—**ï¼šè®°å½•æ¯ä¸ªè½¬æ¢æ­¥éª¤ï¼Œä¾¿äºè°ƒè¯•

## ğŸš€ ä¸‹ä¸€æ­¥

å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œä½ å¯ä»¥è€ƒè™‘ï¼š
1. **å‘å¸ƒåˆ°npm**ï¼šå°†æ–°ç‰ˆæœ¬å‘å¸ƒåˆ° `@musistudio/llms`
2. **æ›´æ–°æ–‡æ¡£**ï¼šåœ¨é¡¹ç›®READMEä¸­æ·»åŠ NewAPIä½¿ç”¨è¯´æ˜
3. **ç‰ˆæœ¬å›é€€**ï¼šå¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›é€€åˆ°npmç‰ˆæœ¬

## ğŸ”§ æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ `config.json` ä¸­çš„API URLå’Œå¯†é’¥
2. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼Œå¯»æ‰¾NewAPITransformeræ³¨å†Œä¿¡æ¯
3. å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼šè®¾ç½® `"LOG": true`

## å›é€€åˆ°npmç‰ˆæœ¬

å¦‚æœéœ€è¦å›é€€ï¼š
```bash
# 1. ä¿®æ”¹package.json
"@musistudio/llms": "^1.0.4"

# 2. é‡æ–°å®‰è£…
npm install
``` 